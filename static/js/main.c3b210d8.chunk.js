(window["webpackJsonpsolid-beer-app-demo"]=window["webpackJsonpsolid-beer-app-demo"]||[]).push([[0],{218:function(e,t,n){e.exports=n(453)},223:function(e,t,n){},240:function(e,t){},242:function(e,t){},250:function(e,t){},252:function(e,t){},293:function(e,t){},295:function(e,t){},343:function(e,t){},344:function(e,t){},405:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=405},434:function(e,t){},437:function(e,t){},447:function(e,t){},448:function(e,t){},451:function(e,t,n){},453:function(e,t,n){"use strict";n.r(t);var r=n(3),a=n.n(r),o=n(214),s=n.n(o),u=n(0),c=n(1),i=n(7),l=n(8),p=n(59),h=n(9),d=(n(223),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(l.a)(t).call(this,e))).animateButton=function(e){e.preventDefault(),n.setState({className:"animate"}),setTimeout((function(){n.setState({className:""})}),700),n.props.onClick()},n.state={className:""},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement("button",{className:"bubbly-button "+this.state.className,onClick:this.animateButton},"One up the BEER")}}]),t}(a.a.Component)),f=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=1===this.props.value?"BEER":"BEERS";return a.a.createElement("div",{className:"record"},a.a.createElement("p",{className:"topRecord"},"on ",this.props.date," you drank"),a.a.createElement("p",{className:"bottomRecord"},this.props.value," ",e))}}]),t}(a.a.Component),b=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.beerCounter.getOrderedDateList().map((function(t){return a.a.createElement(f,{key:t,date:t,value:String(e.props.beerCounter.getValueOnDate(t)).padStart(2,"0")})}));return a.a.createElement("div",{className:"listContainer"},t,a.a.createElement("br",null),a.a.createElement("br",null))}}]),t}(a.a.Component),m=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=1===this.props.beers?"BEER":"BEERS";return a.a.createElement("div",{className:"today"},a.a.createElement("p",null,"Today You Drank"),a.a.createElement("p",{className:"amount"},a.a.createElement("span",{className:"todayBeer"},this.props.beers," ",e)))}}]),t}(a.a.Component),v=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement("button",{onClick:this.props.onClick,className:"authButton"},"Log Out")}}]),t}(a.a.Component),y=function(e){function t(){return Object(u.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement("button",{onClick:this.props.onClick,className:"authButton"},"Log In")}}]),t}(a.a.Component),g=n(5),w=n.n(g),k=n(27),O=n(122),C=n(87),E=n(452),j=E.Namespace("http://www.w3.org/ns/solid/terms#"),x=E.Namespace("http://purl.org/dc/terms/"),S=E.Namespace("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),D=E.Namespace("https://ozcanseker.inrupt.net/vocabulary#"),T=E.Namespace("http://www.w3.org/ns/pim/space#"),L=E.Namespace("http://www.w3.org/ns/auth/acl#"),N=E.sym("https://ozcanseker.inrupt.net/vocabulary#BeerCounterRecord");function B(e){return P.apply(this,arguments)}function P(){return(P=Object(k.a)(w.a.mark((function e(t){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t+"beercounter",e.next=3,C.fetch(n+".ttl");case 3:if(!(e.sent.status%400<100)){e.next=8;break}return e.abrupt("return","beercounter");case 8:return e.abrupt("return",n="beercounter"+I(10));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=n.length,a=0;a<e;a++)t+=n.charAt(Math.floor(Math.random()*r));return t}function F(e){var t=e.split("/");return new Date(Date.UTC(t[2],t[1]-1,t[0]))}function R(e,t,n){return A.apply(this,arguments)}function A(){return(A=Object(k.a)(w.a.mark((function e(t,n,r){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C.fetch(t,{method:"POST",headers:{"Content-Type":"text/turtle",Link:'<http://www.w3.org/ns/ldp#Resource>; rel="type"',SLUG:n},body:r});case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e,t){return M.apply(this,arguments)}function M(){return(M=Object(k.a)(w.a.mark((function e(t,n){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C.fetch(t,{method:"PUT",headers:{"Content-Type":"text/turtle"},body:n});case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var q=function(){function e(t,n,r,a){Object(u.a)(this,e),this.webid=t,this.applocation=n,this.appStore=r,this.beerCounter=a,this.beerCounter.subscribe(this),this.queryList=[],this.networking=!1}return Object(c.a)(e,[{key:"update",value:function(){var e={date:this.beerCounter.getDateToday(),amount:this.beerCounter.getBeerCount()};this.queryList.push(e),this.networking||this.startSendingFile()}},{key:"startSendingFile",value:function(){var e=Object(k.a)(w.a.mark((function e(){var t,n,r,a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(this.networking=!0;this.queryList.length>0;)t=this.queryList.shift(),n=t.date,(r=this.appStore.any(null,null,F(n)))?this.appStore.any(r,S("value"),null).value=t.amount+"":(r=E.blankNode(),this.appStore.add(r,S("type"),D("BeerCounterRecord")),this.appStore.add(r,x("created"),F(n)),this.appStore.add(r,S("value"),t.amount));return e.next=4,E.serialize(void 0,this.appStore,"text/turtle");case 4:return a=e.sent,console.log(this.applocation),e.next=8,U(this.applocation,a);case 8:this.queryList.length>0?this.startSendingFile():this.networking=!1;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"build",value:function(){var t=Object(k.a)(w.a.mark((function t(n){var r,a,o,s,u,c,i,l;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.checkSession();case 2:return r=t.sent,a=E.sym(r.webId),t.next=6,this.getUserCard(r);case 6:o=t.sent,t.prev=7,this.checkacess(o),t.next=14;break;case 11:throw t.prev=11,t.t0=t.catch(7),t.t0;case 14:return t.next=16,this.getPPILocation(a,o);case 16:return s=t.sent,t.next=19,this.getStorePublic(a,o);case 19:return u=t.sent,t.next=22,this.getApplicationLocation(s.ppi,s.store,u);case 22:return c=t.sent,t.next=25,this.getAppStore(c);case 25:return i=t.sent,l=this.getDatesAndCountsFromStore(i),n.setCountsPerDate(l),t.abrupt("return",new e(r.webId,c,i,n));case 29:case"end":return t.stop()}}),t,this,[[7,11]])})));return function(e){return t.apply(this,arguments)}}()},{key:"checkacess",value:function(e){var t=e.any(void 0,L("origin"),E.sym("https://ozcanseker.github.io")),n=e.match(t,L("mode"),L("Read")),r=e.match(t,L("mode"),L("Write")),a=e.match(t,L("mode"),L("Append"));if(!n.length)throw new Error("No Read acess");if(!r.length)throw new Error("No Write acess");if(!a.length)throw new Error("No Append acess")}},{key:"getAppStore",value:function(){var e=Object(k.a)(w.a.mark((function e(t){var n,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=E.graph(),e.next=3,O.fetch(t);case 3:return r=e.sent,e.next=6,E.parse(r,n,t,"text/turtle");case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getApplicationLocation",value:function(){var e=Object(k.a)(w.a.mark((function e(t,n,r){var a,o;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=E.sym(t.value+"#BeerCounter"),o=n.any(a,j("instance"))){e.next=8;break}return e.next=5,this.createAppNodeForPublicTypeIndex(n,t,r,a);case 5:return e.abrupt("return",e.sent);case 8:return e.next=10,this.checkIntegrity(o.value,r);case 10:return e.abrupt("return",o.value);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"checkIntegrity",value:function(){var e=Object(k.a)(w.a.mark((function e(t,n){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.fetch(t);case 2:if(404!==e.sent.status){e.next=7;break}return e.next=6,R(n,t.match("[^/]+$")[0].replace(".ttl",""),"");case 6:console.log("app not found");case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getUserCard",value:function(){var e=Object(k.a)(w.a.mark((function e(t){var n,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.fetch(t.webId);case 2:return n=e.sent,r=E.graph(),E.parse(n,r,t.webId,"text/turtle"),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPPILocation",value:function(){var e=Object(k.a)(w.a.mark((function e(t,n){var r,a,o;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.any(t,j("publicTypeIndex")),a=E.graph(),e.next=4,O.fetch(r.value);case 4:return o=e.sent,E.parse(o,a,r.value,"text/turtle"),e.abrupt("return",{store:a,ppi:r});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getStorePublic",value:function(e,t){return t.any(e,T("storage")).value+"public/"}},{key:"getDatesAndCountsFromStore",value:function(e){var t=e.each(null,null,D("BeerCounterRecord")),n=new Map;return t.forEach((function(t){var r=e.any(t,S("value")),a=e.any(t,x("created"));a=function(e){var t=String(e.getDate()).padStart(2,"0"),n=String(e.getMonth()+1).padStart(2,"0"),r=e.getFullYear();return t+"/"+n+"/"+r}(new Date(a.value)),n.set(a,r.value)})),n}},{key:"createAppNodeForPublicTypeIndex",value:function(){var e=Object(k.a)(w.a.mark((function e(t,n,r,a){var o,s;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B(r);case 2:return o=e.sent,e.next=5,R(r,o,"");case 5:return o=r+o+".ttl",o=E.sym(o),t.add(n,x("references"),a),t.add(a,S("type"),j("TypeRegistration")),t.add(a,j("forClass"),N),t.add(a,j("instance"),o),e.next=13,E.serialize(void 0,t,n.value,"text/turtle");case 13:return s=e.sent,e.next=16,U(n.value,s);case 16:return e.abrupt("return",o.value);case 17:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}()}]),e}(),z=function(){function e(){Object(u.a)(this,e),this.subscribers=[],this.countsPerDate=new Map}return Object(c.a)(e,[{key:"getOrderedDateList",value:function(){return Array.from(this.countsPerDate.keys()).sort((function(e,t){var n=e.split("/"),r=new Date(Date.UTC(n[2],n[1]-1,n[0])),a=t.split("/");return new Date(Date.UTC(a[2],a[1]-1,a[0])).getTime()-r.getTime()}))}},{key:"getValueOnDate",value:function(e){return this.countsPerDate.get(e)}},{key:"setCountsPerDate",value:function(e){this.countsPerDate=e,this.upDateSubScribers()}},{key:"getBeerCount",value:function(){return this.countsPerDate.has(this.dateToday())?this.getValueOnDate(this.dateToday()):0}},{key:"getDateToday",value:function(){return this.dateToday()}},{key:"increaeCountToday",value:function(){var e,t=this.dateToday();e=this.countsPerDate.has(t)?this.countsPerDate.get(t):0,e++,this.countsPerDate.set(t,e),this.upDateSubScribers()}},{key:"upDateSubScribers",value:function(){this.subscribers.map((function(e){return e.update()}))}},{key:"subscribe",value:function(e){this.subscribers.push(e)}},{key:"unsubscribe",value:function(e){this.subscribers.filter((function(t){return t===e}))}},{key:"dateToday",value:function(){var e=new Date;return String(e.getDate()).padStart(2,"0")+"/"+String(e.getMonth()+1).padStart(2,"0")+"/"+e.getFullYear()}}]),e}(),W=n(122),Y=n(87),V=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(i.a)(this,Object(l.a)(t).call(this,e))).checkForLogin=function(){n.state.beerCounter&&n.state.beerCounter.unsubscribe(),W.checkSession().then((function(e){var t=new z;t.subscribe(Object(p.a)(n)),e?(n.setState({isLoggedIn:!0,beerCounter:t}),q.build(t).then((function(e){n.setState({hasFetched:!0,amountOfBeersToday:n.state.beerCounter.getBeerCount(),dateToday:n.state.beerCounter.getDateToday()})})).catch((function(e){console.log(e),n.setState({error:!0})}))):n.setState({isLoggedIn:!1})}),(function(e){return n.setState({isLoggedIn:!1})}))},n.update=function(){n.setState({amountOfBeersToday:n.state.beerCounter.getBeerCount(),dateToday:n.state.beerCounter.getDateToday()})},n.handleLogIn=function(){Y.popupLogin({popupUri:"./popup.html"}).then((function(){n.checkForLogin()}))},n.handleLogOut=function(){W.logout().then(n.setState({isLoggedIn:!1}))},n.increaseBeers=function(){n.state.beerCounter.increaeCountToday()},n.state={isLoggedIn:!1,error:void 0},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.checkForLogin()}},{key:"render",value:function(){var e,t,n,r;if(this.state.isLoggedIn)if(e=a.a.createElement(v,{onClick:this.handleLogOut}),this.state.error)r=a.a.createElement("p",{className:"error"},"The application does not have correct access, Please fix this by giving this application Read, Write and Append access in your pod");else if(this.state.hasFetched){var o=a.a.createElement(b,{beerCounter:this.state.beerCounter}),s=a.a.createElement(d,{onClick:this.increaseBeers}),u=a.a.createElement(m,{date:this.state.dateToday,beers:this.state.amountOfBeersToday});t=a.a.createElement("section",null,u,s,o)}else n=a.a.createElement("section",{id:"rendering"},a.a.createElement("h3",null,"Fetching data"),a.a.createElement("div",{id:"fetchinAnimation"}));else e=a.a.createElement(y,{onClick:this.handleLogIn}),n=a.a.createElement("section",{id:"rendering"},a.a.createElement("h3",null,"Please log in"),a.a.createElement("br",null),a.a.createElement("p",null,"You need a solid pod to log in"),a.a.createElement("p",null,"You can get one ",a.a.createElement("a",{href:"https://solid.inrupt.com/get-a-solid-pod"},"here")));return a.a.createElement("div",null,a.a.createElement("header",null,a.a.createElement("h1",null,"Beer counter")),a.a.createElement("section",{id:"authDiv"},e),n,t,r,a.a.createElement("footer",null,a.a.createElement("span",null,"This application is powered by"),a.a.createElement("a",{href:"https://solid.inrupt.com/"},a.a.createElement("img",{alt:"Solid inrupt",src:"/Solid-Pod-beer-counter/Knipsel.png"}))))}}]),t}(a.a.Component);n(451),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(a.a.createElement(V,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[218,1,2]]]);
//# sourceMappingURL=main.c3b210d8.chunk.js.map