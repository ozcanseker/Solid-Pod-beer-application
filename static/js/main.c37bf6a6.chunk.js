(window["webpackJsonpsolid-beer-app-demo"]=window["webpackJsonpsolid-beer-app-demo"]||[]).push([[0],{240:function(e,t,n){e.exports=n(506)},245:function(e,t,n){},246:function(e,t,n){},247:function(e,t,n){},248:function(e,t,n){},249:function(e,t,n){},271:function(e,t){},273:function(e,t){},281:function(e,t){},283:function(e,t){},324:function(e,t){},326:function(e,t){},374:function(e,t){},375:function(e,t){},436:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=436},465:function(e,t){},468:function(e,t){},478:function(e,t){},479:function(e,t){},482:function(e,t,n){},506:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(70),s=n.n(c),o=n(1),i=n(2),u=n(7),l=n(5),p=n(41),h=n(8),m=(n(245),n(246),function(e){function t(e){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).call(this,e))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"oneUpButtonContainer"},r.a.createElement("div",{className:"containerCircleBorder",onClick:this.props.onClick},r.a.createElement("div",{className:"oneUpButtonCircle"},r.a.createElement("div",{className:"circleBorder"},r.a.createElement("div",{className:"innerCircle"},r.a.createElement("div",{className:"oneUpButton"},r.a.createElement("p",null,"One up the BEER")))))))}}]),t}(r.a.Component)),d=(n(247),function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=1===this.props.value?"BEER":"BEERS";return r.a.createElement("div",{className:"record"},r.a.createElement("p",{className:"topRecord"},this.props.date),r.a.createElement("div",{className:"bottomRecordWrapper"},r.a.createElement("p",{className:"bottomRecord"},this.props.value," ",e)))}}]),t}(r.a.Component)),f=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props.beerCounter.getOrderedDateList().map((function(t){return r.a.createElement(d,{key:t,date:t,value:String(e.props.beerCounter.getValueOnDate(t)).padStart(2,"0")})}));return r.a.createElement("div",{className:"listContainer"},t,r.a.createElement("br",null),r.a.createElement("br",null))}}]),t}(r.a.Component),b=(n(248),function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=1===this.props.beers?"BEER":"BEERS";return r.a.createElement("div",{className:"today"},r.a.createElement("p",null,"Today You Drank"),r.a.createElement("p",{className:"amount"},r.a.createElement("span",{className:"todayBeer"},this.props.beers," ",e)))}}]),t}(r.a.Component)),g=n(520),v=n(73),y=(n(249),function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e,t=Object(v.a)((function(e){return{root:{background:"linear-gradient(45deg, #DCC17D 30%, #ddb74d 90%)",border:0,borderRadius:3,boxShadow:"0 2px 5px 2px rgba(150, 150, 50, .3)",color:"white",height:48,padding:"0 30px",margin:8,float:"right"}}}))(g.a);return e=this.props.loggedIn?"Log out":"Log in",r.a.createElement("section",{className:"authDiv"},r.a.createElement(t,{variant:"contained",color:"primary",onClick:this.props.onClick},e))}}]),t}(r.a.Component)),E=n(9),w=n.n(E),k=n(33),O=n(237),x=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).message="Access file is not correct",n}return Object(h.a)(t,e),t}(Object(O.a)(Error)),j=n(255),C=n(62),S=n(505),N=S.Namespace("http://www.w3.org/ns/solid/terms#"),D=S.Namespace("http://purl.org/dc/terms/"),T=S.Namespace("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),L=S.Namespace("https://ozcanseker.inrupt.net/vocabulary#"),B=S.Namespace("http://www.w3.org/ns/pim/space#"),I=S.Namespace("http://www.w3.org/ns/auth/acl#"),P=S.sym("https://ozcanseker.inrupt.net/vocabulary#BeerCounterRecord");function F(e){return new Promise((function(t){setTimeout(t,e)}))}function A(e){return R.apply(this,arguments)}function R(){return(R=Object(k.a)(w.a.mark((function e(t){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t+"beercounter",e.next=3,C.fetch(n+".ttl");case 3:if(!(e.sent.status%400<100)){e.next=8;break}return e.abrupt("return","beercounter");case 8:return e.abrupt("return",n="beercounter"+U(10));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=n.length,r=0;r<e;r++)t+=n.charAt(Math.floor(Math.random()*a));return t}function M(e){var t=e.split("/");return new Date(Date.UTC(t[2],t[1]-1,t[0]))}function W(e,t,n){return z.apply(this,arguments)}function z(){return(z=Object(k.a)(w.a.mark((function e(t,n,a){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C.fetch(t,{method:"POST",headers:{"Content-Type":"text/turtle",Link:'<http://www.w3.org/ns/ldp#Resource>; rel="type"',SLUG:n},body:a});case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e,t){return Y.apply(this,arguments)}function Y(){return(Y=Object(k.a)(w.a.mark((function e(t,n){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C.fetch(t,{method:"PUT",headers:{"Content-Type":"text/turtle"},body:n});case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var V=function(){function e(t,n,a,r){Object(o.a)(this,e),this.webid=t,this.applocation=n,this.appStore=a,this.beerCounter=r,this.beerCounter.subscribe(this),this.queryList=[],this.networking=!1}return Object(i.a)(e,[{key:"update",value:function(){var e={date:this.beerCounter.getDateToday(),amount:this.beerCounter.getBeerCount()};this.queryList.push(e),this.networking||this.startSendingFile()}},{key:"startSendingFile",value:function(){var e=Object(k.a)(w.a.mark((function e(){var t,n,a,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(this.networking=!0;this.queryList.length>0;)t=this.queryList.shift(),n=t.date,(a=this.appStore.any(null,null,M(n)))?this.appStore.any(a,T("value"),null).value=t.amount+"":(a=S.blankNode(),this.appStore.add(a,T("type"),L("BeerCounterRecord")),this.appStore.add(a,D("created"),M(n)),this.appStore.add(a,T("value"),t.amount));return e.next=4,S.serialize(void 0,this.appStore,"text/turtle");case 4:return r=e.sent,e.next=7,q(this.applocation,r);case 7:this.queryList.length>0?this.startSendingFile():this.networking=!1;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"build",value:function(){var t=Object(k.a)(w.a.mark((function t(n){var a,r,c,s,o,i,u,l;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.checkSession();case 2:return a=t.sent,r=S.sym(a.webId),t.next=6,this.getUserCard(a);case 6:c=t.sent,t.prev=7,this.checkacess(c),t.next=14;break;case 11:throw t.prev=11,t.t0=t.catch(7),t.t0;case 14:return t.next=16,this.getPPILocation(r,c);case 16:return s=t.sent,t.next=19,this.getStorePublic(r,c);case 19:return o=t.sent,t.next=22,this.getApplicationLocation(s.ppi,s.store,o);case 22:return i=t.sent,t.next=25,this.getAppStore(i);case 25:return u=t.sent,l=this.getDatesAndCountsFromStore(u),n.setCountsPerDate(l),t.abrupt("return",new e(a.webId,i,u,n));case 29:case"end":return t.stop()}}),t,this,[[7,11]])})));return function(e){return t.apply(this,arguments)}}()},{key:"checkacess",value:function(e){var t=e.any(void 0,I("origin"),S.sym("https://ozcanseker.github.io")),n=e.match(t,I("mode"),I("Read")),a=e.match(t,I("mode"),I("Write")),r=e.match(t,I("mode"),I("Append"));if(!n.length)throw new x("No Read acess");if(!a.length)throw new x("No Write acess");if(!r.length)throw new x("No Append acess")}},{key:"getAppStore",value:function(){var e=Object(k.a)(w.a.mark((function e(t){var n,a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=S.graph(),e.next=3,j.fetch(t);case 3:return a=e.sent,e.next=6,S.parse(a,n,t,"text/turtle");case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getApplicationLocation",value:function(){var e=Object(k.a)(w.a.mark((function e(t,n,a){var r,c;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=S.sym(t.value+"#BeerCounter"),c=n.any(r,N("instance"))){e.next=8;break}return e.next=5,this.createAppNodeForPublicTypeIndex(n,t,a,r);case 5:return e.abrupt("return",e.sent);case 8:return e.next=10,this.checkIntegrity(c.value,a);case 10:return e.abrupt("return",c.value);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"checkIntegrity",value:function(){var e=Object(k.a)(w.a.mark((function e(t,n){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.fetch(t);case 2:if(404!==e.sent.status){e.next=7;break}return e.next=6,W(n,t.match("[^/]+$")[0].replace(".ttl",""),"");case 6:console.log("app not found");case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getUserCard",value:function(){var e=Object(k.a)(w.a.mark((function e(t){var n,a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.fetch(t.webId);case 2:return n=e.sent,a=S.graph(),S.parse(n,a,t.webId,"text/turtle"),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPPILocation",value:function(){var e=Object(k.a)(w.a.mark((function e(t,n){var a,r,c;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.any(t,N("publicTypeIndex")),r=S.graph(),e.next=4,j.fetch(a.value);case 4:return c=e.sent,S.parse(c,r,a.value,"text/turtle"),e.abrupt("return",{store:r,ppi:a});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getStorePublic",value:function(e,t){return t.any(e,B("storage")).value+"public/"}},{key:"getDatesAndCountsFromStore",value:function(e){var t=e.each(null,null,L("BeerCounterRecord")),n=new Map;return t.forEach((function(t){var a=e.any(t,T("value")),r=e.any(t,D("created"));r=function(e){var t=String(e.getDate()).padStart(2,"0"),n=String(e.getMonth()+1).padStart(2,"0"),a=e.getFullYear();return t+"/"+n+"/"+a}(new Date(r.value)),n.set(r,a.value)})),n}},{key:"createAppNodeForPublicTypeIndex",value:function(){var e=Object(k.a)(w.a.mark((function e(t,n,a,r){var c,s;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(a);case 2:return c=e.sent,e.next=5,W(a,c,"");case 5:return c=a+c+".ttl",c=S.sym(c),t.add(n,D("references"),r),t.add(r,T("type"),N("TypeRegistration")),t.add(r,N("forClass"),P),t.add(r,N("instance"),c),e.next=13,S.serialize(void 0,t,n.value,"text/turtle");case 13:return s=e.sent,e.next=16,q(n.value,s);case 16:return e.next=18,F(4e3);case 18:return e.abrupt("return",c.value);case 19:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}()}]),e}(),J=function(){function e(){Object(o.a)(this,e),this.subscribers=[],this.countsPerDate=new Map}return Object(i.a)(e,[{key:"getOrderedDateList",value:function(){return Array.from(this.countsPerDate.keys()).sort((function(e,t){var n=e.split("/"),a=new Date(Date.UTC(n[2],n[1]-1,n[0])),r=t.split("/");return new Date(Date.UTC(r[2],r[1]-1,r[0])).getTime()-a.getTime()}))}},{key:"getValueOnDate",value:function(e){return this.countsPerDate.get(e)}},{key:"setCountsPerDate",value:function(e){this.countsPerDate=e,this.upDateSubScribers()}},{key:"getBeerCount",value:function(){return this.countsPerDate.has(this.dateToday())?this.getValueOnDate(this.dateToday()):0}},{key:"getDateToday",value:function(){return this.dateToday()}},{key:"increaeCountToday",value:function(){var e,t=this.dateToday();e=this.countsPerDate.has(t)?this.countsPerDate.get(t):0,e++,this.countsPerDate.set(t,e),this.upDateSubScribers()}},{key:"upDateSubScribers",value:function(){this.subscribers.map((function(e){return e.update()}))}},{key:"subscribe",value:function(e){this.subscribers.push(e)}},{key:"unsubscribe",value:function(e){this.subscribers.filter((function(t){return t===e}))}},{key:"dateToday",value:function(){var e=new Date;return String(e.getDate()).padStart(2,"0")+"/"+String(e.getMonth()+1).padStart(2,"0")+"/"+e.getFullYear()}}]),e}(),G=(n(482),function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"bubbles-container"},r.a.createElement("svg",{className:"bubbles",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 701 1024",style:{overflow:"visible"}},r.a.createElement("g",{className:"bubbles-large",strokeWidth:"7"},r.a.createElement("g",null,r.a.createElement("g",{transform:"translate(10 940)"},r.a.createElement("circle",{cx:"35",cy:"35",r:"35"}))),r.a.createElement("g",null,r.a.createElement("g",{transform:"translate(373 940)"},r.a.createElement("circle",{cx:"35",cy:"35",r:"35"}))),r.a.createElement("g",null,r.a.createElement("g",{transform:"translate(408 940)"},r.a.createElement("circle",{cx:"35",cy:"35",r:"35"}))),r.a.createElement("g",null,r.a.createElement("g",{transform:"translate(621 940)"},r.a.createElement("circle",{cx:"35",cy:"35",r:"35"}))),r.a.createElement("g",null,r.a.createElement("g",{transform:"translate(179 940)"},r.a.createElement("circle",{cx:"35",cy:"35",r:"35"})))),r.a.createElement("g",{className:"bubbles-small",strokeWidth:"4"},r.a.createElement("g",null,r.a.createElement("g",{transform:"translate(147 984)"},r.a.createElement("circle",{cx:"15",cy:"15",r:"15"}))),r.a.createElement("g",null,r.a.createElement("g",{transform:"translate(255 984)"},r.a.createElement("circle",{cx:"15",cy:"15",r:"15"}))),r.a.createElement("g",null,r.a.createElement("g",{transform:"translate(573 984)"},r.a.createElement("circle",{cx:"15",cy:"15",r:"15"}))),r.a.createElement("g",null,r.a.createElement("g",{transform:"translate(429 984)"},r.a.createElement("circle",{cx:"15",cy:"15",r:"15"}))),r.a.createElement("g",null,r.a.createElement("g",{transform:"translate(91 984)"},r.a.createElement("circle",{cx:"15",cy:"15",r:"15"}))),r.a.createElement("g",null,r.a.createElement("g",{transform:"translate(640 984)"},r.a.createElement("circle",{cx:"15",cy:"15",r:"15"}))),r.a.createElement("g",null,r.a.createElement("g",{transform:"translate(321 984)"},r.a.createElement("circle",{cx:"15",cy:"15",r:"15"}))),r.a.createElement("g",null,r.a.createElement("g",{transform:"translate(376 984)"},r.a.createElement("circle",{cx:"15",cy:"15",r:"15"}))),r.a.createElement("g",null,r.a.createElement("g",{transform:"translate(376 984)"},r.a.createElement("circle",{cx:"15",cy:"15",r:"15"}))),r.a.createElement("g",null,r.a.createElement("g",{transform:"translate(497 984)"},r.a.createElement("circle",{cx:"15",cy:"15",r:"15"})))))))}}]),t}(r.a.Component)),K=n(62),$=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("span",{className:"emoji",role:"img","aria-label":this.props.label?this.props.label:"","aria-hidden":this.props.label?"false":"true",style:{"font-size":"4em"}},this.props.symbol)}}]),t}(r.a.Component),_=n(235),H=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).checkForLogin=function(){n.state.beerCounter&&n.state.beerCounter.unsubscribe(),K.currentSession().then((function(e){var t=new J;t.subscribe(Object(p.a)(n)),e?(n.setState({isLoggedIn:!0,beerCounter:t,hasFetched:!1}),V.build(t).then((function(e){n.setState({hasFetched:!0,amountOfBeersToday:n.state.beerCounter.getBeerCount(),dateToday:n.state.beerCounter.getDateToday()})})).catch((function(e){e instanceof x&&n.setState({accessError:!0}),n.setState({error:!0,fetchingFiles:!1})}))):n.setState({isLoggedIn:!1})}))},n.update=function(){n.setState({amountOfBeersToday:n.state.beerCounter.getBeerCount(),dateToday:n.state.beerCounter.getDateToday()})},n.handleLogIn=function(){K.popupLogin({popupUri:"./popup.html"}).then((function(){n.checkForLogin()}))},n.handleLogOut=function(){K.logout().then(n.setState({isLoggedIn:!1}))},n.increaseBeers=function(){n.state.beerCounter.increaeCountToday()},n.state={isLoggedIn:!1,error:void 0,accessError:void 0},n}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.checkForLogin()}},{key:"render",value:function(){var e,t,n;if(this.state.isLoggedIn)if(this.state.error)n=this.state.accessError?"The application does not have correct access, Please fix this by giving this application Read, Write and Append access in your pod.":"Try refreshing the page.",e=r.a.createElement("div",{className:"error"},r.a.createElement($,{symbol:"\ud83d\ude14"}),r.a.createElement("p",null,"Something went wrong",r.a.createElement("br",null),r.a.createElement("br",null),n));else if(this.state.hasFetched){var a=r.a.createElement(f,{beerCounter:this.state.beerCounter}),c=r.a.createElement(m,{onClick:this.increaseBeers}),s=r.a.createElement(b,{date:this.state.dateToday,beers:this.state.amountOfBeersToday});e=r.a.createElement("section",{className:"loggedInSection"},s,c,a),t=r.a.createElement(G,null)}else e=r.a.createElement("section",{className:"rendering"},r.a.createElement("h3",null,"Fetching data"),r.a.createElement("div",{className:"loaderDiv"},r.a.createElement(_.BeatLoader,{size:"50",color:"white"})));else e=r.a.createElement("section",null,r.a.createElement("h3",null,"Please log in"),r.a.createElement("br",null),r.a.createElement("p",null,"You need a solid pod to log in."),r.a.createElement("p",null,"You can get one ",r.a.createElement("a",{href:"https://solid.inrupt.com/get-a-solid-pod"},"here.")));return r.a.createElement("section",{className:"App "+(this.state.isLoggedIn&&this.state.hasFetched?"appLoggedIn":"appNotLoggedIn")},r.a.createElement("header",null,r.a.createElement("h1",null,"Beer counter")),r.a.createElement(y,{className:"authButtonApp",loggedIn:this.state.isLoggedIn,onClick:this.state.isLoggedIn?this.handleLogOut:this.handleLogIn}),r.a.createElement("section",{className:"appSection"},e),r.a.createElement("footer",null,r.a.createElement("span",null,"This application is powered by"),r.a.createElement("a",{href:"https://solid.inrupt.com/"},r.a.createElement("img",{alt:"Solid inrupt",src:"/Solid-Pod-beer-counter/Knipsel.png"}))),t)}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(H,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[240,1,2]]]);
//# sourceMappingURL=main.c37bf6a6.chunk.js.map